openapi: 3.0.1
info:
  title: Spring Boot OpenAPI
  description: API 명세
  contact:
    name: kimdoyeob
    url: https://github.com/KalGookSoo/springboot-msa
    email: look3915@naver.com
  license:
    name: Apache 2.0
    url: http://springdoc.org
  version: 1.0.0
servers:
- url: http://localhost:8080
  description: Generated server url
tags:
- name: UserRestController
  description: 계정 API
paths:
  /users/{id}:
    get:
      tags:
      - UserRestController
      operationId: findById
      parameters:
      - name: id
        in: path
        description: 계정 식별자
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: OK
          content:
            application/hal+json:
              schema:
                $ref: '#/components/schemas/EntityModelUser'
    put:
      tags:
      - UserRestController
      operationId: updateById
      parameters:
      - name: id
        in: path
        description: 계정 식별자
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserCommand'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/hal+json:
              schema:
                $ref: '#/components/schemas/EntityModelUser'
    delete:
      tags:
      - UserRestController
      operationId: deleteById
      parameters:
      - name: id
        in: path
        description: 계정 식별자
        required: true
        schema:
          type: string
          format: uuid
      responses:
        "200":
          description: OK
  /users/{id}/password:
    put:
      tags:
      - UserRestController
      operationId: updatePassword
      parameters:
      - name: id
        in: path
        description: 계정 식별자
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserPasswordCommand'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/hal+json:
              schema:
                $ref: '#/components/schemas/EntityModelUser'
  /users:
    get:
      tags:
      - UserRestController
      operationId: findAll
      parameters:
      - name: Authorization
        in: header
        description: "Bearer ${token}"
        required: true
        schema:
          type: string
      - name: search
        in: query
        required: true
        schema:
          $ref: '#/components/schemas/UserSearch'
      responses:
        "200":
          description: OK
          content:
            application/hal+json:
              schema:
                $ref: '#/components/schemas/PagedModelEntityModelUser'
    post:
      tags:
      - UserRestController
      operationId: create
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUserCommand'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/hal+json:
              schema:
                $ref: '#/components/schemas/EntityModelUser'
  /users/sign-in:
    post:
      tags:
      - UserRestController
      operationId: signIn
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SignInCommand'
        required: true
      responses:
        "200":
          description: OK
          content:
            application/hal+json:
              schema:
                $ref: '#/components/schemas/EntityModelUserSummary'
components:
  schemas:
    UpdateUserCommand:
      required:
      - name
      type: object
      properties:
        name:
          maxLength: 20
          minLength: 2
          type: string
        emailId:
          type: string
        emailDomain:
          type: string
        firstContactNumber:
          type: string
        middleContactNumber:
          type: string
        lastContactNumber:
          type: string
      description: 계정 정보를 업데이트하는 데 사용되는 명령
    ContactNumber:
      type: object
      properties:
        first:
          type: string
        middle:
          type: string
        last:
          type: string
        value:
          type: string
    Email:
      type: object
      properties:
        id:
          type: string
        domain:
          type: string
        value:
          type: string
    EntityModelUser:
      type: object
      properties:
        id:
          type: string
        username:
          type: string
        name:
          type: string
        email:
          $ref: '#/components/schemas/Email'
        contactNumber:
          $ref: '#/components/schemas/ContactNumber'
        createdAt:
          type: string
          format: date-time
        modifiedAt:
          type: string
          format: date-time
        expiredAt:
          type: string
          format: date-time
        lockedAt:
          type: string
          format: date-time
        credentialsExpiredAt:
          type: string
          format: date-time
        accountNonLocked:
          type: boolean
        accountNonExpired:
          type: boolean
        credentialsNonExpired:
          type: boolean
        enabled:
          type: boolean
        _links:
          $ref: '#/components/schemas/Links'
    Links:
      type: object
      additionalProperties:
        $ref: '#/components/schemas/Link'
    User:
      type: object
      properties:
        id:
          type: string
        username:
          type: string
        name:
          type: string
        email:
          $ref: '#/components/schemas/Email'
        contactNumber:
          $ref: '#/components/schemas/ContactNumber'
        createdAt:
          type: string
          format: date-time
        modifiedAt:
          type: string
          format: date-time
        expiredAt:
          type: string
          format: date-time
        lockedAt:
          type: string
          format: date-time
        credentialsExpiredAt:
          type: string
          format: date-time
        accountNonLocked:
          type: boolean
        accountNonExpired:
          type: boolean
        credentialsNonExpired:
          type: boolean
        enabled:
          type: boolean
    UpdateUserPasswordCommand:
      required:
      - newPassword
      - originPassword
      type: object
      properties:
        originPassword:
          type: string
        newPassword:
          type: string
      description: 계정 패스워드 업데이트 명령
    CreateUserCommand:
      required:
      - name
      - password
      - username
      type: object
      properties:
        username:
          maxLength: 20
          minLength: 3
          type: string
        password:
          maxLength: 2147483647
          minLength: 8
          type: string
        name:
          maxLength: 20
          minLength: 2
          type: string
        emailId:
          type: string
        emailDomain:
          type: string
        firstContactNumber:
          type: string
        middleContactNumber:
          type: string
        lastContactNumber:
          type: string
      description: 계정을 생성하는 데 사용되는 명령
    SignInCommand:
      required:
      - password
      - username
      type: object
      properties:
        username:
          maxLength: 20
          minLength: 3
          type: string
        password:
          maxLength: 2147483647
          minLength: 8
          type: string
      description: 로그인 명령
    Authority:
      type: object
      properties:
        id:
          type: string
        userId:
          type: string
        name:
          type: string
    EntityModelUserSummary:
      type: object
      properties:
        user:
          $ref: '#/components/schemas/User'
        authorities:
          type: array
          items:
            $ref: '#/components/schemas/Authority'
        _links:
          $ref: '#/components/schemas/Links'
    UserSearch:
      type: object
      properties:
        page:
          type: integer
          description: 페이지 인덱스
          format: int32
          default: 0
        size:
          type: integer
          description: 페이지 당 출력할 레코드 수
          format: int32
          default: 10
        sort:
          type: string
          description: 정렬할 필드
          default: createdAt
        sortDirection:
          type: string
          description: 정렬 방향
          default: desc
        username:
          type: string
          description: 계정명(대체키)
        name:
          type: string
          description: 계정명(또는 별칭)
        emailId:
          type: string
          description: 이메일 ID
        contactNumber:
          type: string
          description: 연락처
    PageMetadata:
      type: object
      properties:
        size:
          type: integer
          format: int64
        totalElements:
          type: integer
          format: int64
        totalPages:
          type: integer
          format: int64
        number:
          type: integer
          format: int64
    PagedModelEntityModelUser:
      type: object
      properties:
        _embedded:
          type: object
          properties:
            users:
              type: array
              items:
                $ref: '#/components/schemas/EntityModelUser'
        _links:
          $ref: '#/components/schemas/Links'
        page:
          $ref: '#/components/schemas/PageMetadata'
    Link:
      type: object
      properties:
        href:
          type: string
        hreflang:
          type: string
        title:
          type: string
        type:
          type: string
        deprecation:
          type: string
        profile:
          type: string
        name:
          type: string
        templated:
          type: boolean
